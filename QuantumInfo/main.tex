\documentclass[dvipdfmx]{jarticle}

\usepackage{qcircuit}
\usepackage{mathrsfs}
\usepackage{tcolorbox}
\usepackage[margin = 20mm]{geometry}
\usepackage{amsmath, amsthm, amssymb}
\usepackage{physics}
\usepackage{titlesec}
\titleformat{\section}[hang]{\bfseries\gtfamily}{\thesection}{12pt}{}

\newtcolorbox{gray}{
  colback = gray!30!white,
  colframe = gray!30!white,
  sharp corners
}

\numberwithin{equation}{section}

\newtheoremstyle{seminar}
  {1ex}
  {1ex}
  {}
  {}
  {\bfseries}
  {}
  {1em}
  {}

\makeatletter
\renewenvironment{proof}[1][\proofname]{\par
  \pushQED{\qed}
  \normalfont \topsep6\p@\@plus6\p@\relax
  \trivlist
  \item\relax
  {\itshape
  #1\@addpunct{ }}\hspace\labelsep\ignorespaces
}{
  \popQED\endtrivlist\@endpefalse
}

\makeatother
\theoremstyle{seminar}                            
\newtheorem{theorem}{定理}[section]
\newtheorem{definition}{定義}[section]
\newtheorem{proposition}{命題}[section]
\newtheorem{axiom}{公理}[section]
\newtheorem{example}{例}[section]
\newtheorem{corollary}{系}[section]
\newtheorem{remark}{注}[section]
\newtheorem*{solution}{（解）}
\newtheorem{lemma}{補題}[section]

\newcommand{\id}{\mathrm{id}}
\newcommand{\st}{\,\mathrm{s.t.}\,}

\renewcommand{\proofname}{\textbf{証明}}                          

\makeatletter
\def\@maketitle{
\begin{flushright}
{\large \@date}
\end{flushright}
\begin{center}
{\large \@title \par}
\end{center}
\begin{flushright}
{\@author}
\end{flushright} 
\par\vskip 1.5em
}
\makeatother

\title{{\bf Lecture Note on Quantum Algorithms for Scientific Computation\footnote{\texttt{https://arxiv.org/abs/2201.08309}} 輪講メモ}}
\author{阪大原子核理論研　大和 寛尚}
\date{}
\begin{document}
\maketitle
\section{エラーに関する重要な定理（教科書1.6節）}
最初に演算子に対してノルムを定めておく．
\begin{definition}
  演算子$A$のノルムを${\displaystyle \| A \| = \sup_{\|\ket{\varphi}\| = 1} \| A \ket{\varphi} \|}$と定める．これはノルムが満たすべき性質をすべて満たす．
\end{definition}
\begin{remark}
  明らかにユニタリ演算子のノルムは1である．
\end{remark}
%% TODO - ノルムの性質を書いておくこと
ローカルなエラーのグローバルなエラーへの寄与に関して次の2つの重要な定理がある．
\begin{proposition}
  ユニタリ演算子
  \begin{align}
    U_j, \tilde{U}_j \in \mathbb{C}^{N \times N} ; \quad \| U_j - \tilde{U}_j\| < \epsilon, \quad j = 1, 2, \cdots, K
  \end{align}
  に対して，次が成り立つ．
  \begin{align}
    \| U_K \cdots U_1 - \tilde{U}_K \cdots \tilde{U}_i \| \leq K\epsilon
  \end{align}
\end{proposition}

\begin{proof}
  次の式変形が可能である．
  \begin{align}
    \begin{split}
      \|U_K \cdots U_1 - \tilde{U}_K \cdots \tilde{U}_i\|
      &= \| U_K U_{K-1} \cdots U_3U_2U_1 - U_KU_{K-1} \cdots U_3U_2\tilde{U}_1 \\
      &\,\,\,\,+ U_K U_{K-1} \cdots U_3U_2\tilde{U}_1 - U_KU_{K-1} \cdots U_3\tilde{U}_2\tilde{U}_1 \\
      &\,\,\,\,+ \cdots \\
      &\,\,\,\,+ U_K \tilde{U}_{K-1} \cdots \tilde{U}_3 \tilde{U}_2 \tilde{U}_1 - \tilde{U}_K \tilde{U}_{K-1} \cdots \tilde{U}_3 \tilde{U}_2 \tilde{U}_1 \| \\
      &= \| U_K U_{K-1} \cdots U_3 U_2 (U_1 - \tilde{U}_1) + U_K U_{K-1} \cdots U_3 (U_2 - \tilde{U}_2) \tilde{U}_1 \\ &\,\,\,\,+  \cdots + (U_K - \tilde{U}_{K})\tilde{U}_{K-1} \cdots \tilde{U}_3 \tilde{U}_2 \tilde{U}_1 \| \\
      &\leq \| U_K U_{K-1} \cdots U_3 U_2 (U_1 - \tilde{U}_1) \| + \| U_K U_{K-1} \cdots U_3 (U_2 - \tilde{U}_2) \tilde{U}_1 \| \\
      &\,\,\,\,+ \cdots + \| U_K U_{K-1} \cdots U_3 (U_2 - \tilde{U}_2) \tilde{U}_1 \| \\
      &= \| U_1 - \tilde{U}_1 \| + \| U_2 - \tilde{U}_2 \| + \cdots + \| U_K - \tilde{U}_{K-1} \| 
    \end{split}
  \end{align}
  ここで，ノルムの三角不等式，劣乗法性，および，ユニタリ演算子のノルムが1であることを用いている．よって
  \begin{align}
    \|U_K \cdots U_1 - \tilde{U}_K \cdots \tilde{U}_i\| \leq \sum_{j = 1}^{K} \| U_j - \tilde{U}_j \| \leq K\epsilon
  \end{align}
  を得る．
\end{proof}

\begin{proposition}
  Schrödinger方程式を満たす時間発展演算子
  \begin{align}
    U(t), \tilde{U}(t) \in \mathbb{C}^{N \times N}; \quad i\dv{U(t)}{t} = HU(t), \quad i\dv{\tilde{U}(t)}{t} = H\tilde{U}(t) + B(t), \quad U(0) = \tilde{U}(0) = I
  \end{align}
  に対して次が成り立つ．
  \begin{align}
    \tilde{U}(t) = U(t) - i \int_0^t \dd t' U(t - t')B(t'), \quad \| U(t) - \tilde{U}(t) \| < \int_0^t \dd t' \| B(t')\| \label{solution}
  \end{align}
\end{proposition}

\begin{proof}
  上述の$\tilde{U}(t)$が方程式
  \begin{align}
    i\dv{\tilde{U}(t)}{t} = H\tilde{U}(t) + B(t)
  \end{align}
  を満たすことを実際に代入することによって示す．
  \begin{align}
    \begin{split}
      i\dv{\tilde{U}}{t} - H\tilde{U}(t) - B(t) &= i\dv{U(t)}{t} + \dv{t}\int_0^t \dd t' U(t - t') B(t') - HU(t) + iH\int_0^t \dd t' U(t - t')B(t') - B(t) \\
      &= i\dv{U(t)}{t} + \dv{t}\qty{U(t)\int_0^t \dd t' U(- t') B(t')} - HU(t) + iHU(t)\int_0^t \dd t' U(-t')B(t') - B(t) \\
      &= i\dv{U(t)}{t} + \dv{U(t)}{t} \int_0^t \dd t' U(-t')B(t') + U(t) U(-t)B(t) -i\dv{U(t)}{t} - \dv{U(t)}{t} \int_0^t \dd t' U(-t')B(t') - B(t) \\
      &= 0
    \end{split}
  \end{align}
  ここで，時間発展演算子の性質$U(t_1 + t_2) = U(t_1)U(t_2)$を用いている．
\end{proof}

\begin{remark}
  命題1.2は斉次方程式の解$U(t)$が与えられたとき，非斉次方程式の解$\tilde{U}(t)$が
  \begin{align}
    \tilde{U}(t) = U(t) - i\int_0^t \dd t' U(t - t')B(t')
  \end{align}
  で与えられる，という命題であるとみなせる．
\end{remark}

\begin{corollary}
  命題1.2において$B(t) = E(t)\tilde{U}(t)$（ここで，$E(t)$は各時刻におけるエラーである）とすると
  \begin{align}
    \| U(t) - \tilde{U}(t) \| < \int_0^t \dd t' \| E(t') \|
  \end{align}
  を得る．これは時間発展演算子に関する命題1.1の連続な場合への拡張とみなせる．
\end{corollary}
\section{量子ゲートの構成（教科書1.7節）}

\begin{definition}
  量子ゲートの集合$\mathcal{S}$を用いて任意のユニタリ演算子$U$を任意の精度$\epsilon$で構成できるとき，つまり
  \begin{align}
    \| U - U_m U_{m-1} \cdots U_1 \| < \epsilon, \quad U_j \in \mathcal{S}, \quad j = 1, 2, \cdots, m
  \end{align}
  となる$U_j$の組を取ることができるとき，集合$\mathcal{S}$は{\bf 万能}（universal）であるという．
\end{definition}

\begin{remark}
  万能な量子ゲートの集合$\mathcal{S}$は存在し，複数存在する．
\end{remark}

複数存在する万能な量子ゲートの集合$\mathcal{S}$がすべて等価であることを主張する定理がある．証明は省略．
\begin{theorem}（Solovay \& Kitaev）
  可逆な量子ゲートの集合$\mathcal{S}, \mathcal{T}$は万能であるとする．$\mathcal{S}$に含まれる$m$個の量子ゲートからなる任意の量子回路は$\mathcal{T}$に含まれる$\mathcal{O}\qty(m \log^c (m / \epsilon))$個の量子ゲートを用いて再現できる．そして，そのような回路の構成を$\mathcal{O}\qty(m \log^c (m / \epsilon))$の時間で発見する古典アルゴリズムが存在する．
\end{theorem}

\begin{example}
  万能な量子ゲートの集合の例として
  \begin{align}
    \qty{H, T, \mathrm{CNOT}}, \quad \qty{H, \mathrm{Toffoli}}
  \end{align}
  などがある．
\end{example}

\section{量子計算機の性能（教科書1.7節）}
まず，{\bf アンコンピュテーション}（uncomputation）と呼ばれる方法を導入する．これは（必ずしも可逆とは限らない）任意の古典回路
\begin{align}
  f: \qty{0, 1}^n \rightarrow \qty{0, 1}^m; \quad x \mapsto f(x)
\end{align}
に対応する可逆計算を構成する方法である．

可逆性を担保するための一つのアイデアとして入力（古典回路$f: x \mapsto f(x)$の$x$）を用意したレジスタに記録しておく，というものがある．そのような回路は入力レジスタ，結果レジスタ，補助レジスタを用意して，次のようにユニタリ演算を実現する．
\begin{align}
  U_f: \underbrace{\,\ket{x}\,}_{入力}\underbrace{\,\ket{0^m}\,}_{結果}\underbrace{\,\ket{0^w}\,}_{補助} \mapsto \ket{x}\ket{f(x)}\ket{g(x)}
\end{align}
計算の過程で生じる，ゴミは次のようにして可逆な過程で回収できる．新たにもう一つレジスタを追加し，結果をそこにコピーしておく．つまり
\begin{align}
  \ket{x}\ket{f(x)}\ket{g(x)}\underbrace{\ket{0^m}}_{追加したレジスタ} \longrightarrow \ket{x}\ket{f(x)}\ket{g(x)}\ket{f(x)}
\end{align}
とする．いま$\ket{f(x)}$は計算基底のいずれかであるから，これは古典的なコピーであり量子複製禁止定理に抵触しない．続いて，$U_f$のユニタリ性を用いて次のような操作を行う．
\begin{align}
  U^\dagger_f \otimes I \ket{x}\ket{f(x)}\ket{g(x)}\ket{f(x)} = \ket{x}\ket{0^m}\ket{0^w}\ket{f(x)}
\end{align}
最後に結果レジスタに結果を再格納する．これはSWAPゲートによって可能である．
\begin{align}
  \ket{x}\ket{0^m}\ket{0^w}\ket{f(x)} \longrightarrow \ket{x}\ket{f(x)}\ket{0^w}\ket{0^m}
\end{align}
これで，可逆な操作として古典回路を再現することができた．

\begin{remark}
  先述の，最終的に$\ket{0^m}$や$\ket{0^w}$に初期化されるレジスタを無視して次のように表記することがある．
  \begin{align}
    V_f \ket{x}\ket{0^m} = \ket{x}\ket{f(x)}
  \end{align}
\end{remark}
\begin{proposition}
  量子計算機は古典計算機と少なくとも同等の性能を持つ．（古典計算機で行える計算は量子計算機でも行える）
\end{proposition}

\begin{proof}
  先述のアンコンピュテーションの方法を用いれば，プリミティブな古典回路（例えばNAND）を量子回路として再現できる．任意の古典回路はそのようなプリミティブな回路から構成できるのであったから，プリミティブな回路を量子回路として再現できた以上，量子計算は自明に古典計算を含むことが言える．
\end{proof}

\begin{example}
  Toffoliゲートにおいてターゲット・ビットの入力を1としておけば，このゲートは２つのコントロール・ビットを入力とし，ターゲット・ビットを出力とするNANDゲートと等価である．任意の古典回路はNANDゲートから構成可能であるので，量子計算は古典計算を含む．
\end{example}

%% \begin{gray}
%%   {\bf Exercise 1.9} \hspace{1em} 写像$f: \qty{0, 1}^n \rightarrow \qty{0, 1}^n$が全単射であるとき，逆写像が存在し，$U_f: \ket{x} \mapsto \ket{f(x)}$を量子計算機上に実装できることを示せ．
%% \end{gray}

%% \begin{solution}
%%   全単射である写像$f: X \rightarrow Y$に対して逆写像が存在することはより一般に示せる．いま，$f$は全単射であるからすべての$y \in Y$に対して$y = f(x)$となるような$x$がただ一つ存在する．ここで，$g: Y \rightarrow X$を$g(y) = x$となるように定めると$f^{-1} = g$である．よって，逆写像が存在する．

  
%% \end{solution}
%% \section{固定少数点数の表現（教科書1.8節）}

\begin{thebibliography}{9}
\item Lin Lin, Lecture Notes on Quantum Algorithms for Scientific Computation
\item 石坂智・小川朋宏・河内亮周・木村元・林正人，「量子情報科学入門」共立出版
\item 藤井啓祐，「量子コンピュータの基礎と物理の接点」物性研究・電子版2017年11月号
\end{thebibliography}
\end{document}
